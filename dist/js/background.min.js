function getCookie(e){var t=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return t?unescape(t[2]):null}function loadList(){try{var e=new XMLHttpRequest;e.open("GET","http://www.softomate.net/ext/employees/list.json",!0),e.onreadystatechange=function(){if(4==e.readyState){var t=e.responseText,i=JSON.parse(t),n=JSON.stringify(i),o=new Date((new Date).getTime()+period);document.cookie="list="+n+"; path=/; expires="+o.toUTCString(),document.cookie="date="+Now;for(var a=0;a<i.length;a++){for(var s=0,r=0;r<links.length;r++)i[a]==links[r]&&s++;0==s&&(links[links.length]=i[a],counts[counts.length]=0)}setTimeout(loadList,period)}},e.send()}catch(e){alert("Отсутствует интернет")}}var links=new Array,counts=new Array,period=36e5,cookieList=getCookie("list");if(null==cookieList)loadList();else{var cookieDate=getCookie("date"),Now=(new Date).getTime(),Interval=cookieDate+period-Now;setTimeout(loadList,Interval)}chrome.runtime.onMessage.addListener(function(e,t,i){for(var n="",o=0;o<links.length;o++)e.greeting.indexOf(links[o].name)>-1&&(n=counts[o]<3?links[o].message:"0",counts[o]=counts[o]+1,i({farewell:n}));if("close"==e.greeting){for(var o=0;o<links.length;o++)t.tab.url.indexOf(links[o].name)>-1&&(counts[o]=4,i({farewell:"Closed"}));i({farewell:"goodbye"})}});